create or replace TRIGGER suppr_vip
BEFORE DELETE ON VIP
FOR EACH ROW
BEGIN
	DELETE FROM APPEL WHERE IDVIP = :OLD.ID_VIP;
	DELETE FROM FAX WHERE IDVIP = :OLD.ID_VIP;
	DELETE FROM MAIL WHERE IDVIP = :OLD.ID_VIP;

	FOR i IN (SELECT ID_VIP FROM VIP WHERE ID_COMPAGNON = :OLD.ID_VIP) LOOP
		UPDATE VIP SET ID_COMPAGNON = i WHERE ID_VIP = i;
	END LOOP;
END suppr_vip;